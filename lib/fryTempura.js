"use strict";var u=class extends Error{constructor(t,n=`Unsupported type: ${t}`){super(n)}};var k=e=>({ch:e.col,line:e.line});function w(e){return app.vault.adapter.exists(e)}var c=()=>app.workspace.getActiveFile();function Ue(){return app.metadataCache.getFileCache(c())}function b(){return app.vault.getMarkdownFiles()}function E(){return app.vault.fileMap}function g(e){let t=app.vault.getAbstractFileByPath(e);return t||null}function Be(e){let t=g(e);return t?app.metadataCache.getFileCache(t):null}var p=()=>Ue()?.frontmatter??null,S=e=>Be(e)?.sections?.filter(t=>t.type==="code")??[],o=()=>app.workspace.activeEditor?.editor,l=()=>app.workspace.activeEditor.metadataEditor;function f(){let e=o();return e.getLine(e.getCursor().line)}function U(){return app.metadataCache.getBacklinksForFile(c()).data}function d(){return o().getSelection()}async function h(e,t){let n=g(e);if(!n)return null;let r=await app.vault.cachedRead(n);return t?r.slice(t.start.offset,t.end.offset):r}function B(e){let t=o();return e?t.getRange(k(e.start),k(e.end)):t.getValue()}function x(e){o().replaceSelection(e)}function D(){let e=o(),t=e.getCursor();t.line===e.lastLine()?e.setLine(t.line,""):e.replaceRange("",{line:t.line,ch:0},{line:t.line+1,ch:0})}function $(e,t){let n=o(),{line:r,ch:i}=n.getCursor();n.setLine(r,e);let a=t?.cursor==="last"?e.length:Math.min(i,e.length-1);n.setCursor({line:r,ch:a})}function I(e){let t=o();t.replaceRange(`
${e}`,{line:t.lastLine()+1,ch:0})}function R(e,t){new Notice(e,t??null)}function s(e){return moment(e)}function F(){return app.plugins.plugins["templater-obsidian"].templater.current_functions_object}function _(){return app.plugins.plugins["periodic-notes"]}async function N(){return app.internalPlugins.plugins.publish.instance.apiCustomUrl().then(e=>e.url)}function j(e,t=""){return app.vault.create(e,t)}function O(e,t){let n=t?.newLeaf??!1;return app.workspace.openLinkText("",e,n)}function v(e,t="asc"){return(n,r)=>t==="asc"?e(n)>e(r)?1:e(r)>e(n)?-1:0:e(n)<e(r)?1:e(r)<e(n)?-1:0}function V(e,t,n="asc"){return e.slice().sort(v(t,n))}function Y(e){let t=Array.from(e.matchAll(/^(?<prefix>[ \t\s]*([-*] (\[.] |)|))(?<content>.*)$/g)).at(0);return{prefix:t?.groups?.prefix??"",content:t?.groups?.content??""}}function H(e){return e.split(" ").filter(t=>t.startsWith("#")).map(t=>t.slice(1))}function W(e){return e.replaceAll(/\*\*([^*]*?)\*\*/g,"$1").replaceAll(/__([^*]*?)__/g,"$1").replaceAll(/\*([^*]*?)\*/g,"$1").replaceAll(/_([^*]*?)_/g,"$1").replaceAll(/~~([^~]*?)~~/g,"$1").replaceAll(/==([^~]*?)==/g,"$1")}function q(e){return e.replaceAll(/\[\[[^\|\]]*?\|([^\]]*?)\]\]/g,"$1").replaceAll(/\[\[([^\]]*?)\]\]/g,"$1").replaceAll(/\[([^\]]*?)\]\(.*?\)/g,"$1").replaceAll(/\[([^\]]*?)\]/g,"$1")}function z(e,t){let n=[],r=moment(e).startOf("day"),i=moment(t).startOf("day");if(r.isAfter(i))throw new Error("beginDate is after endDate");for(;n.push(r.clone()),!(r.add(1,"days").diff(i)>0););return n}function G(e){return e!=null}function J(){return{editor:o(),properties:p(),metadataEditor:l()}}function A(e,t){l().insertProperties({[e]:t})}function K(e){l().insertProperties(e)}function Q(){return p()}function X(e,t){y(e),A(e,t)}function y(e){l().insertProperties({[e]:null})}function Z(){return p()?.tags??[]}function ee(){return p()?.aliases??[]}function te(e){l().focusValue(e)}function ne(e){let t=o();t.replaceRange(e,t.getCursor())}function re(e){I(e)}function P(){return f()}function ie(){return D()}function oe(){return H(P())}function M(){return d().split(`
`)}function T(e){o()?.replaceSelection(e)}async function se(){return L(c().path)}async function L(e){let t=S(e),n=[];for(let r of t){let i=await h(e,r.position),a=i.match(/[`~]{3,}(?<language>[^ \n]*)/)?.groups?.language||null;n.push({language:a,content:i.split(`
`).slice(1).slice(0,-1).join(`
`),position:r.position})}return n}function ae(e,t){let n=f(),{prefix:r,content:i}=Y(n),a=t?.attached??"prefix",m;switch(a){case"prefix":m=`${r}${e}${i}`;break;case"suffix":m=`${r}${i}${e}`;break;default:throw new u(a)}$(m,{cursor:t?.cursor})}function ce(e){let t=e?.order??"asc",n=e?.predicate??(a=>a),r=M();if(!r)return;let i=V(r,n,t);T(i.join(`
`))}function le(){let e=W(d());x(e)}function pe(){let e=q(d());x(e)}function ue(e,t=5e3){R(e,t==="never"?void 0:t)}function ge(){return Object.keys(U()??{})}function de(e){let t=c().stat.ctime;switch(e){case"unixtime":return t;case"moment":return s(t);default:return s(t).format(e)}}function me(e){let t=c().stat.mtime;switch(e){case"unixtime":return t;case"moment":return s(t);default:return s(t).format(e)}}function fe(e){let t=s();switch(e){case"unixtime":return t.unix();case"moment":return t;default:return t.format(e)}}function he(e){return s(e)}function xe(e){return F().system.prompt(e)}function Fe(e,t){return F().system.suggester(e,t)}function ve(e,t){let n=_()?.settings.daily;if(!n)throw new Error("Periodic Notes plugin is not installed.");return z(s(e),s(t)).map(r=>g(`${n.folder}/${r.format(n.format||"YYYY-MM-DD")}.md`)).filter(G)}async function Ae(e,t){let n=await h(e,t);if(n==null)throw new Error(`${e} is not existed.`);return n}function ye(e){let t=B(e);if(t==null)throw new Error("Couldn't get content from the active file.");return t}function Pe(){return c().path}function Me(e){return w(e)}async function Te(e,t){return j(e,t)}function C(){return E()}function Le(){return Object.values(C())}function Ce(){return b()}async function ke(e,t){return O(e,t)}async function we(e){await navigator.clipboard.writeText(e)}async function be(e){return`https://${await N()}/${encodeURI(e.replace(".md",""))}`}function Ee(e){return new Error(e)}function Se(e,t="asc"){return v(e,t)}module.exports=()=>({addProperties:K,addProperty:A,appendLine:re,attachTextToListItem:ae,copyToClipboard:we,createFile:Te,createMomentDate:he,createObsidianPublishUrl:be,deleteActiveLine:ie,exit:Ee,fileExists:Me,focusPropertyValue:te,getActiveFileContent:ye,getActiveFilePath:Pe,getActiveLine:P,getActiveLineTags:oe,getAllFiles:Le,getAllFilesByPath:C,getAllMarkdownFiles:Ce,getBacklinkPaths:ge,getCodeBlocks:se,getCodeBlocksFrom:L,getCreationDate:de,getDailyNotes:ve,getFileContent:Ae,getProperties:Q,getSelectionLines:M,getUpdateDate:me,insert:ne,notify:ue,now:fe,openFile:ke,readAliasesFromProperty:ee,readTagsFromProperty:Z,removeProperty:y,setTextToSelection:T,showInputDialog:xe,showSelectionDialog:Fe,sorter:Se,sortSelectionLines:ce,stripDecorationFromSelection:le,stripLinksFromSelection:pe,updateProperty:X,use:J});
