"use strict";var u=class extends Error{constructor(t,n=`Unsupported type: ${t}`){super(n)}};var T=e=>({ch:e.col,line:e.line});function b(e){return app.vault.adapter.exists(e)}var a=()=>app.workspace.getActiveFile();function Te(){let e=a();return e?app.metadataCache.getFileCache(e):null}function L(){return app.vault.fileMap}function g(e){let t=app.vault.getAbstractFileByPath(e);return t||null}function be(e){let t=g(e);return t?app.metadataCache.getFileCache(t):null}var p=()=>Te()?.frontmatter??null,k=e=>be(e)?.sections?.filter(t=>t.type==="code")??[],o=()=>app.workspace.activeEditor?.editor??null,c=()=>app.workspace.activeEditor.metadataEditor??null;function d(){let e=o();return e?e.getLine(e.getCursor().line):null}function w(){let e=a();return e?app.metadataCache.getBacklinksForFile(e).data:null}function m(){let e=o();return e?e.getSelection():null}async function h(e,t){let n=g(e);if(!n)return null;let r=await app.vault.cachedRead(n);return t?r.slice(t.start.offset,t.end.offset):r}function E(e){let t=o();return t?e?t.getRange(T(e.start),T(e.end)):t.getValue():null}function x(e){let t=o();t&&t.replaceSelection(e)}function S(){let e=o();if(!e)return;let t=e.getCursor();t.line===e.lastLine()?e.setLine(t.line,""):e.replaceRange("",{line:t.line,ch:0},{line:t.line+1,ch:0})}function U(e,t){let n=o();if(!n)return;let{line:r,ch:i}=n.getCursor();n.setLine(r,e);let l=t?.cursor==="last"?e.length:Math.min(i,e.length-1);n.setCursor({line:r,ch:l})}function B(e,t){new Notice(e,t??null)}function s(e){return moment(e)}function D(){return app.plugins.plugins["templater-obsidian"].templater.current_functions_object}function $(){return app.plugins.plugins["periodic-notes"]}async function I(){return app.internalPlugins.plugins.publish.instance.apiCustomUrl().then(e=>e.url)}function _(e,t=""){return app.vault.create(e,t)}function N(e,t){let n=t?.newLeaf??!1;return app.workspace.openLinkText("",e,n)}function ke(e,t="asc"){return(n,r)=>t==="asc"?e(n)>e(r)?1:e(r)>e(n)?-1:0:e(n)<e(r)?1:e(r)<e(n)?-1:0}function R(e,t,n="asc"){return e.slice().sort(ke(t,n))}function j(e){let t=Array.from(e.matchAll(/^(?<prefix>[ \t\s]*([-*] (\[.] |)|))(?<content>.*)$/g)).at(0);return{prefix:t?.groups?.prefix??"",content:t?.groups?.content??""}}function O(e){return e.split(" ").filter(t=>t.startsWith("#")).map(t=>t.slice(1))}function V(e){return e.replaceAll(/\*\*([^*]*?)\*\*/g,"$1").replaceAll(/__([^*]*?)__/g,"$1").replaceAll(/\*([^*]*?)\*/g,"$1").replaceAll(/_([^*]*?)_/g,"$1").replaceAll(/~~([^~]*?)~~/g,"$1").replaceAll(/==([^~]*?)==/g,"$1")}function Y(e){return e.replaceAll(/\[\[[^\|\]]*?\|([^\]]*?)\]\]/g,"$1").replaceAll(/\[\[([^\]]*?)\]\]/g,"$1").replaceAll(/\[([^\]]*?)\]\(.*?\)/g,"$1").replaceAll(/\[([^\]]*?)\]/g,"$1")}function H(e,t){let n=[],r=moment(e).startOf("day"),i=moment(t).startOf("day");if(r.isAfter(i))throw new Error("beginDate is after endDate");for(;n.push(r.clone()),!(r.add(1,"days").diff(i)>0););return n}function W(e){return e!=null}function q(){return{editor:o(),properties:p(),metadataEditor:c()}}function F(e,t){let n=c();n&&n.insertProperties({[e]:t})}function z(e){let t=c();t&&t.insertProperties(e)}function G(){return p()}function J(e,t){v(e),F(e,t)}function v(e){let t=c();t&&t.insertProperties({[e]:null})}function K(){return p()?.tags??[]}function Q(){return p()?.aliases??[]}function X(e){let t=c();t&&t.focusValue(e)}async function Z(e){let t=o();t&&t.replaceRange(e,t.getCursor())}function A(){return d()}function ee(){return S()}function te(){let e=A();return e?O(e):[]}function y(){return o()?.getSelection()?.split(`
`)??null}function P(e){o()?.replaceSelection(e)}async function ne(){let e=a()?.path;return e?M(e):[]}async function M(e){let t=k(e),n=[];for(let r of t){let i=await h(e,r.position),l=i.match(/[`~]{3,}(?<language>[^ \n]*)/)?.groups?.language||null;n.push({language:l,content:i.split(`
`).slice(1).slice(0,-1).join(`
`),position:r.position})}return n}function re(e,t){let n=d(),{prefix:r,content:i}=j(n),l=t?.attached??"prefix",f;switch(l){case"prefix":f=`${r}${e}${i}`;break;case"suffix":f=`${r}${i}${e}`;break;default:throw new u(l)}U(f,{cursor:t?.cursor})}function ie(e){let t=e?.order??"asc",n=e?.predicate??(l=>l),r=y();if(!r)return;let i=R(r,n,t);P(i.join(`
`))}function oe(){let e=m();if(!e)return;let t=V(e);x(t)}function se(){let e=m();if(!e)return;let t=Y(e);x(t)}function le(e,t=5e3){B(e,t==="never"?void 0:t)}function ae(){return Object.keys(w()??{})}function ce(e){let t=a();if(!t)return null;let n=t.stat.ctime;switch(e){case"unixtime":return n;case"moment":return s(n);default:return s(n).format(e)}}function pe(e){let t=a();if(!t)return null;let n=t.stat.mtime;switch(e){case"unixtime":return n;case"moment":return s(n);default:return s(n).format(e)}}function ue(e){let t=s();switch(e){case"unixtime":return t.unix();case"moment":return t;default:return t.format(e)}}function ge(e){return s(e)}function fe(e){return D().system.prompt(e)}function de(e,t){let n=$()?.settings.daily;if(!n)throw new Error("Periodic Notes plugin is not installed.");return H(s(e),s(t)).map(r=>g(`${n.folder}/${r.format(n.format||"YYYY-MM-DD")}.md`)).filter(W)}async function me(e,t){let n=await h(e,t);if(n==null)throw new Error(`${e} is not existed.`);return n}function he(e){let t=E(e);if(t==null)throw new Error("Couldn't get content from the active file.");return t}function xe(){return a()?.path??null}function Fe(e){return b(e)}async function ve(e,t){return _(e,t)}function C(){return L()}function Ae(){return Object.values(C())}async function ye(e,t){return N(e,t)}async function Pe(e){await navigator.clipboard.writeText(e)}async function Me(e){return`https://${await I()}/${encodeURI(e.replace(".md",""))}`}function Ce(e){return new Error(e)}module.exports=()=>({use:q,insert:Z,addProperty:F,addProperties:z,removeProperty:v,updateProperty:J,focusPropertyValue:X,getActiveLine:A,getActiveLineTags:te,getBacklinkPaths:ae,getCreationDate:ce,getUpdateDate:pe,getSelectionLines:y,setTextToSelection:P,attachTextToListItem:re,sortSelectionLines:ie,readTagsFromProperty:K,readAliasesFromProperty:Q,deleteActiveLine:ee,stripDecorationFromSelection:oe,stripLinksFromSelection:se,notify:le,now:ue,showInputDialog:fe,getCodeBlocks:ne,getCodeBlocksFrom:M,getDailyNotes:de,getFileContent:me,getActiveFileContent:he,getActiveFilePath:xe,copyToClipboard:Pe,createObsidianPublishUrl:Me,fileExists:Fe,createFile:ve,openFile:ye,getProperties:G,createMomentDate:ge,getAllFiles:Ae,getAllFilesByPath:C,exit:Ce});
